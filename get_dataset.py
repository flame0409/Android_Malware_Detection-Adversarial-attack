import numpy as np
import tensorflow as tf

def get_data():
    labels_path = "D:\BSWJ\smali\CNN_TF-IDF_only.csv"
    data_path = "D:\BSWJ\smali\CNN_TF-IDF_onlydata.csv"
    labels_path_test = "D:\BSWJ\smali\\test\CNN_TF-IDF_only.csv"
    data_paths_test = "D:\BSWJ\smali\\test\CNN_TF-IDF_onlydata.csv"

    data = np.loadtxt(data_path, skiprows=1, dtype=float, delimiter=',')
    from keras.utils import to_categorical
    # 取标签
    labels = np.loadtxt(labels_path, skiprows=1, dtype=int, usecols=0, delimiter=',')
    data_test = np.loadtxt(data_paths_test, skiprows=1, dtype=float, delimiter=',')
    # 取标签
    labels_test = np.loadtxt(labels_path_test, skiprows=1, dtype=int, usecols=0, delimiter=',')
    data = data * 100  # 归一化缩放
    data_test = data_test * 100
    data = data.astype(np.float32)
    data_test = data_test.astype(np.float32)
    data = data.reshape(-1, 7, 7, 7)
    data_test = data_test.reshape(-1,7,7,7)
    labels = to_categorical(labels)
    labels_test = to_categorical(labels_test)
    return data,labels,data_test,labels_test

